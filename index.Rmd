---
title: 'xGPhilosophy Tweet Engagement'
output: 
  flexdashboard::flex_dashboard:
    css: style.css
    orientation: columns
    vertical_layout: scroll
---

```{r setup, include=F, echo=F}
knitr::opts_chunk$set(
  # collapse = TRUE
  echo = FALSE,
  warning = FALSE,
  message = FALSE
)
```

```{r import, include=F}
source('functions.R')
preds <- import_preds()
# shap <- import_shap()
# 
# df <-
#   shap %>% 
#   nest(shap = -c(stem, idx, .pred)) %>% 
#   select(idx, stem, shap) %>% 
#   pivot_wider(names_from = stem, values_from = shap, names_glue = '{stem}_shap') %>% 
#   left_join(preds)
# df

preds_key <- preds %>% plotly::highlight_key(~text)
# df_key <- df %>% plotly::highlight_key(~text)
```

## Column {data-width="650"}

### Favorites {data-height="600"}

```{r}
favorite_subplots <- preds_key %>% plot_stem('favorite', height = 500, width = 1000)
favorite_subplots
```

### Retweets {data-height="650"}

```{r}
retweet_subplots <- preds_key %>% plot_stem('retweet', height = 500, width = 1000)
retweet_subplots
# subplot(
#   favorite_subplots,
#   retweet_subplots,
#   nrows = 2,
#   margin = 0.04,
#   shareX = FALSE,
#   shareY = FALSE,
#   titleX = TRUE,
#   titleY = TRUE
# )
```

## Column {data-width="400"}

### Favorites

```{r}
# HTML(
#   '<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Liverpool (2.06) 0-1 (0.93) Burnley</p>&mdash; The xG Philosophy (@xGPhilosophy) <a href="https://twitter.com/xGPhilosophy/status/1352373660410146822?ref_src=twsrc%5Etfw">January 21, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>'
# )
# favorite_subplots
```

### Retweets

```{r}
# retweet_subplots
```
