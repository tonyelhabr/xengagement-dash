---
title: 'xGPhilosophy Tweet Engagement'
output: 
  flexdashboard::flex_dashboard:
    css: custom.css
    orientation: columns
    vertical_layout: scroll
---

```{r setup, include=F, echo=F}
knitr::opts_chunk$set(
  # collapse = TRUE
  echo = FALSE,
  warning = FALSE,
  message = FALSE
)
```

```{r import, include=F}
source('functions.R')
preds <- import_preds()
shap <- import_shap()

preds_key <- preds %>% plotly::highlight_key( ~ text)
shap_key <- 
  shap %>% 
  plotly::highlight_key()

plot_time <-
  purrr::partial(
    plot_stem_time,
    data = preds_key,
    width = 475,
    height = 475,
    ... =
  )
plot_pred <-
  purrr::partial(
    plot_stem_pred,
    data = preds_key,
    height = 475,
    width = 475,
    ... =
  )

```

# Sidebar {.sidebar}

```{r}
# shiny inputs defined here
```

This is a tool.

# Prediction Explanation

## Column {data-width="333"}

### Favorite Prediction Explanation {data-height="500"}

```{r}
p <-
  shap_key %>% 
  plotly::plot_ly(
    x = ~shap_value,
    y = ~lab,
    showlegend = FALSE
  )
crosstalk::bscols(
  crosstalk::filter_select('id', 'Select a tweet', shap_key, ~text, multiple = FALSE),
  p,
  widths = c(12, 12)
)

```

### Retweets Prediction Explanation {data-height="500"}

```{r}

```

# Data & Predictions {data-orientation="rows"}

## Column {data-width="333"}

### Favorites {data-height="333"}

```{r}
plot_time('favorite')
```

### Retweets {data-height="333"}

```{r}
plot_time('retweet')
```

## Column {data-width="333"}

### Favorite Predictions {data-height="500"}

```{r}
plot_pred('favorite')
```

### Retweet Predictions {data-height="500"}

```{r}
plot_pred('retweet')
```
